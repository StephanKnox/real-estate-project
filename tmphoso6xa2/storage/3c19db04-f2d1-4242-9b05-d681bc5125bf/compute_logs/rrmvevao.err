[32m2023-05-31 12:14:38 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - 54968 - LOGS_CAPTURED - Started capturing logs in process (pid: 54968).
[32m2023-05-31 12:14:38 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - 54968 - create_delta_table - STEP_START - Started execution of step "create_delta_table".
Ivy Default Cache set to: /Users/ctac/.ivy2/cache
The jars for the packages stored in: /Users/ctac/.ivy2/jars
io.delta#delta-core_2.12 added as a dependency
org.apache.hadoop#hadoop-aws added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-35bf402b-721f-4a4a-b344-e1d3d4736567;1.0
	confs: [default]
	found io.delta#delta-core_2.12;2.1.0 in central
	found io.delta#delta-storage;2.1.0 in central
	found org.antlr#antlr4-runtime;4.8 in central
	found org.codehaus.jackson#jackson-core-asl;1.9.13 in central
	found org.apache.hadoop#hadoop-aws;3.3.2 in central
	found com.amazonaws#aws-java-sdk-bundle;1.11.1026 in central
	found org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central
:: resolution report :: resolve 133ms :: artifacts dl 5ms
	:: modules in use:
	com.amazonaws#aws-java-sdk-bundle;1.11.1026 from central in [default]
	io.delta#delta-core_2.12;2.1.0 from central in [default]
	io.delta#delta-storage;2.1.0 from central in [default]
	org.antlr#antlr4-runtime;4.8 from central in [default]
	org.apache.hadoop#hadoop-aws;3.3.2 from central in [default]
	org.codehaus.jackson#jackson-core-asl;1.9.13 from central in [default]
	org.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   7   |   0   |   0   |   0   ||   7   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-35bf402b-721f-4a4a-b344-e1d3d4736567
	confs: [default]
	0 artifacts copied, 7 already retrieved (0kB/3ms)
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[Stage 0:>                                                          (0 + 1) / 1]                                                                                [32m2023-05-31 12:14:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - 54968 - create_delta_table - LOADED_INPUT - Loaded input "json_to_flat_properties" using input manager "local_parquet_io_manager"
[32m2023-05-31 12:14:43 +0200[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - 54968 - create_delta_table - STEP_INPUT - Got input "json_to_flat_properties" of type "DataFrame". (Type check passed).
[32m2023-05-31 12:14:44 +0200[0m - dagster - [34mINFO[0m - __ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - create_delta_table - 19344
[Stage 6:====================>                                    (18 + 8) / 50][Stage 6:=========================================>               (36 + 8) / 50]                                                                                [32m2023-05-31 12:14:47 +0200[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 3c19db04-f2d1-4242-9b05-d681bc5125bf - 54968 - create_delta_table - STEP_FAILURE - Execution of step "create_delta_table" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "create_delta_table"::

pyspark.sql.utils.AnalysisException: A schema mismatch detected when writing to the Delta table (Table ID: 6298061a-cc9e-4dda-b0ef-5ddcfb004053).
To enable schema migration using DataFrameWriter or DataStreamWriter, please set:
'.option("mergeSchema", "true")'.
For other operations, set the session configuration
spark.databricks.delta.schema.autoMerge.enabled to "true". See the documentation
specific to the operation for details.

Table schema:
root
-- id: string (nullable = true)
-- data_inversa: string (nullable = true)
-- dia_semana: string (nullable = true)
-- horario: string (nullable = true)
-- uf: string (nullable = true)
-- br: string (nullable = true)


Data schema:
root
-- propertyDetails_accountId: long (nullable = true)
-- propertyDetails_availableFrom: string (nullable = true)
-- propertyDetails_availableFromFormatted: string (nullable = true)
-- propertyDetails_cityId: long (nullable = true)
-- propertyDetails_cityName: string (nullable = true)
-- propertyDetails_companyId: long (nullable = true)
-- propertyDetails_contactFormTypeId: long (nullable = true)
-- propertyDetails_countryId: long (nullable = true)
-- propertyDetails_description: string (nullable = true)
-- propertyDetails_geoAccuracy: long (nullable = true)
-- propertyDetails_grossPremiumFormatted: string (nullable = true)
-- propertyDetails_hasNewBuildingProject: boolean (nullable = true)
-- propertyDetails_hasVirtualTour: boolean (nullable = true)
-- propertyDetails_id: long (nullable = true)
-- propertyDetails_isHgCrosslisting: boolean (nullable = true)
-- propertyDetails_isHighlighted: boolean (nullable = true)
-- propertyDetails_isNeubauLite: boolean (nullable = true)
-- propertyDetails_isNeubauLitePremium: boolean (nullable = true)
-- propertyDetails_isNew: boolean (nullable = true)
-- propertyDetails_isNewEndDate: string (nullable = true)
-- propertyDetails_isOnline: boolean (nullable = true)
-- propertyDetails_isPremiumToplisting: boolean (nullable = true)
-- propertyDetails_isQualityListing: boolean (nullable = true)
-- propertyDetails_isTopListing: boolean (nullable = true)
-- propertyDetails_lastModified: string (nullable = true)
-- propertyDetails_lastPublished: string (nullable = true)
-- propertyDetails_latitude: double (nullable = true)
-- propertyDetails_listingCompletenessScore: double (nullable = true)
-- propertyDetails_listingLayout: long (nullable = true)
-- propertyDetails_longitude: double (nullable = true)
-- propertyDetails_memberPackageId: long (nullable = true)
-- propertyDetails_msRegionId: long (nullable = true)
-- propertyDetails_municipalityBfsId: long (nullable = true)
-- propertyDetails_municipalityId: long (nullable = true)
-- propertyDetails_municipalityNameFormatted: string (nullable = true)
-- propertyDetails_normalizedPrice: long (nullable = true)
-- propertyDetails_normalizedPriceFormatted: string (nullable = true)
-- propertyDetails_numberOfRooms: double (nullable = true)
-- propertyDetails_numberOfRoomsFormatted: string (nullable = true)
-- propertyDetails_offerTypeId: long (nullable = true)
-- propertyDetails_packageScore: long (nullable = true)
-- propertyDetails_packageType: long (nullable = true)
-- propertyDetails_price: long (nullable = true)
-- propertyDetails_priceFormatted: string (nullable = true)
-- propertyDetails_priceUnitId: long (nullable = true)
-- propertyDetails_priceUnitLabel: string (nullable = true)
-- propertyDetails_propertyCategoryId: long (nullable = true)
-- propertyDetails_propertyDetailUrl: string (nullable = true)
-- propertyDetails_propertyId: string (nullable = true)
-- propertyDetails_propertyTypeId: long (nullable = true)
-- propertyDetails_referenceNo: string (nullable = true)
-- propertyDetails_regionId: long (nullable = true)
-- propertyDetails_searchCity: string (nullable = true)
-- propertyDetails_searchDate: string (nullable = true)
-- propertyDetails_searchRadius: string (nullable = true)
-- propertyDetails_sellingPrice: long (nullable = true)
-- propertyDetails_sellingPriceFormatted: string (nullable = true)
-- propertyDetails_shortDescription: string (nullable = true)
-- propertyDetails_showContactForm: boolean (nullable = true)
-- propertyDetails_showContactFormAddress: boolean (nullable = true)
-- propertyDetails_sortalgoScore: double (nullable = true)
-- propertyDetails_sortalgoScore2: double (nullable = true)
-- propertyDetails_sortingPosition: long (nullable = true)
-- propertyDetails_state: string (nullable = true)
-- propertyDetails_stateShort: string (nullable = true)
-- propertyDetails_street: string (nullable = true)
-- propertyDetails_surfaceLiving: long (nullable = true)
-- propertyDetails_surfaceLivingFormatted: string (nullable = true)
-- propertyDetails_surfaceProperty: long (nullable = true)
-- propertyDetails_surfacePropertyFormatted: string (nullable = true)
-- propertyDetails_surfaceUsable: long (nullable = true)
-- propertyDetails_surfaceUsableFormatted: string (nullable = true)
-- propertyDetails_title: string (nullable = true)
-- propertyDetails_url: string (nullable = true)
-- propertyDetails_urlTitle: string (nullable = true)
-- propertyDetails_userRelevantScore: double (nullable = true)
-- propertyDetails_videoViewingEnabled: boolean (nullable = true)
-- propertyDetails_visitName: string (nullable = true)
-- propertyDetails_visitPhone: string (nullable = true)
-- propertyDetails_visitRemark: string (nullable = true)
-- propertyDetails_zip: string (nullable = true)
-- propertyDetails_zipId: long (nullable = true)
-- viewData_agencyPhoneStatsUrl: string (nullable = true)
-- viewData_allowOnlineApplication: boolean (nullable = true)
-- viewData_allowOnlineApplicationForAroov: boolean (nullable = true)
-- viewData_anibisUrl: string (nullable = true)
-- viewData_areSimilarPropertiesFromSameAdvertiser: boolean (nullable = true)
-- viewData_aroovOnlineApplicationUrl: string (nullable = true)
-- viewData_debtEnforcementLandingPageUrl: string (nullable = true)
-- viewData_detailPrintStatsUrl: string (nullable = true)
-- viewData_detailViewStatsUrl: string (nullable = true)
-- viewData_financingLinkUrl: string (nullable = true)
-- viewData_movingUrl: string (nullable = true)
-- viewData_showAccountProperties: boolean (nullable = true)
-- viewData_showOnlineApplicationApply: boolean (nullable = true)
-- viewData_showSimilarProperties: boolean (nullable = true)
-- viewData_visitPhoneStatsUrl: string (nullable = true)
-- propertyDetails_agency_companyCity: string (nullable = true)
-- propertyDetails_agency_companyName1: string (nullable = true)
-- propertyDetails_agency_companyName2: string (nullable = true)
-- propertyDetails_agency_companyPhoneBusiness: string (nullable = true)
-- propertyDetails_agency_companyPhoneMobile: string (nullable = true)
-- propertyDetails_agency_companyStreet: string (nullable = true)
-- propertyDetails_agency_companyZip: string (nullable = true)
-- propertyDetails_agency_firstName: string (nullable = true)
-- propertyDetails_agency_gender: string (nullable = true)
-- propertyDetails_agency_isAccountMigrated: boolean (nullable = true)
-- propertyDetails_agency_isGuest: boolean (nullable = true)
-- propertyDetails_agency_lastName: string (nullable = true)
-- propertyDetails_agency_logoUrl: string (nullable = true)
-- propertyDetails_agency_logoUrlDetailPage: string (nullable = true)
-- propertyDetails_agency_nameFormatted: string (nullable = true)
-- propertyDetails_agency_reference: string (nullable = true)
-- propertyDetails_agency_showLogoOnSerp: boolean (nullable = true)
-- propertyDetails_agency_userType: string (nullable = true)
-- propertyDetails_agency_webUrl: string (nullable = true)
-- propertyDetails_attributes_cornerHouse: boolean (nullable = true)
-- propertyDetails_attributes_flatSharingCommunity: boolean (nullable = true)
-- propertyDetails_attributes_middleHouse: boolean (nullable = true)
-- propertyDetails_attributes_newBuilding: boolean (nullable = true)
-- propertyDetails_attributes_oldBuilding: boolean (nullable = true)
-- propertyDetails_attributes_swimmingPool: boolean (nullable = true)
-- propertyDetails_attributes_underBuildingLaws: boolean (nullable = true)
-- propertyDetails_attributes_yearBuilt: long (nullable = true)
-- propertyDetails_attributes_yearRenovated: long (nullable = true)
-- propertyDetails_attributesInside_animalAllowed: boolean (nullable = true)
-- propertyDetails_attributesInside_attic: boolean (nullable = true)
-- propertyDetails_attributesInside_cellar: boolean (nullable = true)
-- propertyDetails_attributesInside_firePlace: boolean (nullable = true)
-- propertyDetails_attributesInside_nrBathRooms: long (nullable = true)
-- propertyDetails_attributesInside_propView: boolean (nullable = true)
-- propertyDetails_attributesInside_reduit: boolean (nullable = true)
-- propertyDetails_attributesInside_wheelChairAccessible: boolean (nullable = true)
-- propertyDetails_attributesOutside_playGround: boolean (nullable = true)
-- propertyDetails_attributesOutside_propBalcony: boolean (nullable = true)
-- propertyDetails_attributesOutside_propChildFriendly: boolean (nullable = true)
-- propertyDetails_attributesOutside_propElevator: boolean (nullable = true)
-- propertyDetails_attributesOutside_propGarage: boolean (nullable = true)
-- propertyDetails_attributesOutside_propParking: boolean (nullable = true)
-- propertyDetails_attributesSize_floor: long (nullable = true)
-- propertyDetails_attributesSize_floorFormatted: string (nullable = true)
-- propertyDetails_attributesSize_numberOfFloors: long (nullable = true)
-- propertyDetails_attributesSize_raisedGroundFloor: boolean (nullable = true)
-- propertyDetails_attributesSize_volume: long (nullable = true)
-- propertyDetails_attributesSize_volumeFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceKindergarten: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceKindergartenFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceMotorway: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceMotorwayFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distancePublicTransport: long (nullable = true)
-- propertyDetails_attributesSurrounding_distancePublicTransportFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool1: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool1Formatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool2: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool2Formatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceShop: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceShopFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_objectSituation: string (nullable = true)
-- propertyDetails_attributesTechnology_dishWasher: boolean (nullable = true)
-- propertyDetails_attributesTechnology_isMinergieCertified: boolean (nullable = true)
-- propertyDetails_attributesTechnology_minergieGeneral: boolean (nullable = true)
-- propertyDetails_attributesTechnology_propCabletv: boolean (nullable = true)
-- propertyDetails_attributesTechnology_separateTumbleDryer: boolean (nullable = true)
-- propertyDetails_attributesTechnology_separateWashingMachine: boolean (nullable = true)
-- propertyDetails_attributesTechnology_steamer: boolean (nullable = true)
-- propertyDetails_images_description: string (nullable = true)
-- propertyDetails_images_id: long (nullable = true)
-- propertyDetails_images_lastModified: string (nullable = true)
-- propertyDetails_images_originalHeight: long (nullable = true)
-- propertyDetails_images_originalWidth: long (nullable = true)
-- propertyDetails_images_sortOrder: long (nullable = true)
-- propertyDetails_images_title: string (nullable = true)
-- propertyDetails_images_url: string (nullable = true)
-- propertyDetails_newBuildingLiteProject_projectDetailUrl: string (nullable = true)
-- propertyDetails_newBuildingLiteProject_projectName: string (nullable = true)
-- propertyDetails_pdfs_description: string (nullable = true)
-- propertyDetails_pdfs_id: long (nullable = true)
-- propertyDetails_pdfs_lastModified: string (nullable = true)
-- propertyDetails_pdfs_sortOrder: long (nullable = true)
-- propertyDetails_pdfs_title: string (nullable = true)
-- propertyDetails_pdfs_url: string (nullable = true)
-- propertyDetails_videos_description: string (nullable = true)
-- propertyDetails_videos_id: long (nullable = true)
-- propertyDetails_videos_lastModified: string (nullable = true)
-- propertyDetails_videos_remoteId: string (nullable = true)
-- propertyDetails_videos_sortOrder: long (nullable = true)
-- propertyDetails_videos_title: string (nullable = true)
-- propertyDetails_virtualTours_description: string (nullable = true)
-- propertyDetails_virtualTours_id: long (nullable = true)
-- propertyDetails_virtualTours_lastModified: string (nullable = true)
-- propertyDetails_virtualTours_sortOrder: long (nullable = true)
-- propertyDetails_virtualTours_title: string (nullable = true)
-- propertyDetails_virtualTours_url: string (nullable = true)
-- viewData_agencyBusinessImage_description: string (nullable = true)
-- viewData_agencyBusinessImage_id: long (nullable = true)
-- viewData_agencyBusinessImage_lastModified: string (nullable = true)
-- viewData_agencyBusinessImage_originalHeight: long (nullable = true)
-- viewData_agencyBusinessImage_originalWidth: long (nullable = true)
-- viewData_agencyBusinessImage_sortOrder: long (nullable = true)
-- viewData_agencyBusinessImage_title: string (nullable = true)
-- viewData_agencyBusinessImage_url: string (nullable = true)
-- viewData_viewDataWeb_accountPropertiesUrl: string (nullable = true)
-- viewData_viewDataWeb_copyShareUrl: string (nullable = true)
-- viewData_viewDataWeb_fbShareUrl: string (nullable = true)
-- viewData_viewDataWeb_whatsAppShareUrl: string (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_defaultPoiId: long (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_label: string (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_isReachable: boolean (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_transportationTypeId: long (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_travelTime: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_activeLanguage: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_countImages: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_countPDF: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_country: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_customerType: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_englishVirtualPagePath: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_floorLevel: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasHighlighting: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasToplisting: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasVideoViewing: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasVirtualTour: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasYoutube: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isCooperation: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isNewBuilding: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isShortUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingAccountId: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingCompletenessScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingId: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingLayout: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_availability: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_cantonName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_locationName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_msregion: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_propertySpace: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_propertyType: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_zip: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_livingSpace: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_localVirtualPagePath: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_numberOfRooms: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_offerTypeName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_packageName: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_packageScore: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_previewImageUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_price: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_sortingScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_streetName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userLoggedIn: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userOrigin: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userRelevantScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_viewTab: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_description: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageHeight: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageType: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageWidth: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_title: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_url: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@context: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_@type: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_availability: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_description: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_image: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_name: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_price: long (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_priceCurrency: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_url: string (nullable = true)

         
To overwrite your schema or change partitioning, please set:
'.option("overwriteSchema", "true")'.

Note that the schema can't be overwritten when using
'replaceWhere'.
         

Stack Trace:
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 443, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 124, in _coerce_solid_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 118, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/realestate-scraping/realestate_scraping/assets/core/realestate_scraping.py", line 241, in create_delta_table
    .save("s3a://real-estate/lake/bronze/property")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/pyspark/sql/readwriter.py", line 968, in save
    self._jwrite.save(path)
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/pyspark/sql/utils.py", line 196, in deco
    raise converted from None

The above exception occurred during handling of the following exception:
py4j.protocol.Py4JJavaError: An error occurred while calling o52.save.
: org.apache.spark.sql.AnalysisException: A schema mismatch detected when writing to the Delta table (Table ID: 6298061a-cc9e-4dda-b0ef-5ddcfb004053).
To enable schema migration using DataFrameWriter or DataStreamWriter, please set:
'.option("mergeSchema", "true")'.
For other operations, set the session configuration
spark.databricks.delta.schema.autoMerge.enabled to "true". See the documentation
specific to the operation for details.

Table schema:
root
-- id: string (nullable = true)
-- data_inversa: string (nullable = true)
-- dia_semana: string (nullable = true)
-- horario: string (nullable = true)
-- uf: string (nullable = true)
-- br: string (nullable = true)


Data schema:
root
-- propertyDetails_accountId: long (nullable = true)
-- propertyDetails_availableFrom: string (nullable = true)
-- propertyDetails_availableFromFormatted: string (nullable = true)
-- propertyDetails_cityId: long (nullable = true)
-- propertyDetails_cityName: string (nullable = true)
-- propertyDetails_companyId: long (nullable = true)
-- propertyDetails_contactFormTypeId: long (nullable = true)
-- propertyDetails_countryId: long (nullable = true)
-- propertyDetails_description: string (nullable = true)
-- propertyDetails_geoAccuracy: long (nullable = true)
-- propertyDetails_grossPremiumFormatted: string (nullable = true)
-- propertyDetails_hasNewBuildingProject: boolean (nullable = true)
-- propertyDetails_hasVirtualTour: boolean (nullable = true)
-- propertyDetails_id: long (nullable = true)
-- propertyDetails_isHgCrosslisting: boolean (nullable = true)
-- propertyDetails_isHighlighted: boolean (nullable = true)
-- propertyDetails_isNeubauLite: boolean (nullable = true)
-- propertyDetails_isNeubauLitePremium: boolean (nullable = true)
-- propertyDetails_isNew: boolean (nullable = true)
-- propertyDetails_isNewEndDate: string (nullable = true)
-- propertyDetails_isOnline: boolean (nullable = true)
-- propertyDetails_isPremiumToplisting: boolean (nullable = true)
-- propertyDetails_isQualityListing: boolean (nullable = true)
-- propertyDetails_isTopListing: boolean (nullable = true)
-- propertyDetails_lastModified: string (nullable = true)
-- propertyDetails_lastPublished: string (nullable = true)
-- propertyDetails_latitude: double (nullable = true)
-- propertyDetails_listingCompletenessScore: double (nullable = true)
-- propertyDetails_listingLayout: long (nullable = true)
-- propertyDetails_longitude: double (nullable = true)
-- propertyDetails_memberPackageId: long (nullable = true)
-- propertyDetails_msRegionId: long (nullable = true)
-- propertyDetails_municipalityBfsId: long (nullable = true)
-- propertyDetails_municipalityId: long (nullable = true)
-- propertyDetails_municipalityNameFormatted: string (nullable = true)
-- propertyDetails_normalizedPrice: long (nullable = true)
-- propertyDetails_normalizedPriceFormatted: string (nullable = true)
-- propertyDetails_numberOfRooms: double (nullable = true)
-- propertyDetails_numberOfRoomsFormatted: string (nullable = true)
-- propertyDetails_offerTypeId: long (nullable = true)
-- propertyDetails_packageScore: long (nullable = true)
-- propertyDetails_packageType: long (nullable = true)
-- propertyDetails_price: long (nullable = true)
-- propertyDetails_priceFormatted: string (nullable = true)
-- propertyDetails_priceUnitId: long (nullable = true)
-- propertyDetails_priceUnitLabel: string (nullable = true)
-- propertyDetails_propertyCategoryId: long (nullable = true)
-- propertyDetails_propertyDetailUrl: string (nullable = true)
-- propertyDetails_propertyId: string (nullable = true)
-- propertyDetails_propertyTypeId: long (nullable = true)
-- propertyDetails_referenceNo: string (nullable = true)
-- propertyDetails_regionId: long (nullable = true)
-- propertyDetails_searchCity: string (nullable = true)
-- propertyDetails_searchDate: string (nullable = true)
-- propertyDetails_searchRadius: string (nullable = true)
-- propertyDetails_sellingPrice: long (nullable = true)
-- propertyDetails_sellingPriceFormatted: string (nullable = true)
-- propertyDetails_shortDescription: string (nullable = true)
-- propertyDetails_showContactForm: boolean (nullable = true)
-- propertyDetails_showContactFormAddress: boolean (nullable = true)
-- propertyDetails_sortalgoScore: double (nullable = true)
-- propertyDetails_sortalgoScore2: double (nullable = true)
-- propertyDetails_sortingPosition: long (nullable = true)
-- propertyDetails_state: string (nullable = true)
-- propertyDetails_stateShort: string (nullable = true)
-- propertyDetails_street: string (nullable = true)
-- propertyDetails_surfaceLiving: long (nullable = true)
-- propertyDetails_surfaceLivingFormatted: string (nullable = true)
-- propertyDetails_surfaceProperty: long (nullable = true)
-- propertyDetails_surfacePropertyFormatted: string (nullable = true)
-- propertyDetails_surfaceUsable: long (nullable = true)
-- propertyDetails_surfaceUsableFormatted: string (nullable = true)
-- propertyDetails_title: string (nullable = true)
-- propertyDetails_url: string (nullable = true)
-- propertyDetails_urlTitle: string (nullable = true)
-- propertyDetails_userRelevantScore: double (nullable = true)
-- propertyDetails_videoViewingEnabled: boolean (nullable = true)
-- propertyDetails_visitName: string (nullable = true)
-- propertyDetails_visitPhone: string (nullable = true)
-- propertyDetails_visitRemark: string (nullable = true)
-- propertyDetails_zip: string (nullable = true)
-- propertyDetails_zipId: long (nullable = true)
-- viewData_agencyPhoneStatsUrl: string (nullable = true)
-- viewData_allowOnlineApplication: boolean (nullable = true)
-- viewData_allowOnlineApplicationForAroov: boolean (nullable = true)
-- viewData_anibisUrl: string (nullable = true)
-- viewData_areSimilarPropertiesFromSameAdvertiser: boolean (nullable = true)
-- viewData_aroovOnlineApplicationUrl: string (nullable = true)
-- viewData_debtEnforcementLandingPageUrl: string (nullable = true)
-- viewData_detailPrintStatsUrl: string (nullable = true)
-- viewData_detailViewStatsUrl: string (nullable = true)
-- viewData_financingLinkUrl: string (nullable = true)
-- viewData_movingUrl: string (nullable = true)
-- viewData_showAccountProperties: boolean (nullable = true)
-- viewData_showOnlineApplicationApply: boolean (nullable = true)
-- viewData_showSimilarProperties: boolean (nullable = true)
-- viewData_visitPhoneStatsUrl: string (nullable = true)
-- propertyDetails_agency_companyCity: string (nullable = true)
-- propertyDetails_agency_companyName1: string (nullable = true)
-- propertyDetails_agency_companyName2: string (nullable = true)
-- propertyDetails_agency_companyPhoneBusiness: string (nullable = true)
-- propertyDetails_agency_companyPhoneMobile: string (nullable = true)
-- propertyDetails_agency_companyStreet: string (nullable = true)
-- propertyDetails_agency_companyZip: string (nullable = true)
-- propertyDetails_agency_firstName: string (nullable = true)
-- propertyDetails_agency_gender: string (nullable = true)
-- propertyDetails_agency_isAccountMigrated: boolean (nullable = true)
-- propertyDetails_agency_isGuest: boolean (nullable = true)
-- propertyDetails_agency_lastName: string (nullable = true)
-- propertyDetails_agency_logoUrl: string (nullable = true)
-- propertyDetails_agency_logoUrlDetailPage: string (nullable = true)
-- propertyDetails_agency_nameFormatted: string (nullable = true)
-- propertyDetails_agency_reference: string (nullable = true)
-- propertyDetails_agency_showLogoOnSerp: boolean (nullable = true)
-- propertyDetails_agency_userType: string (nullable = true)
-- propertyDetails_agency_webUrl: string (nullable = true)
-- propertyDetails_attributes_cornerHouse: boolean (nullable = true)
-- propertyDetails_attributes_flatSharingCommunity: boolean (nullable = true)
-- propertyDetails_attributes_middleHouse: boolean (nullable = true)
-- propertyDetails_attributes_newBuilding: boolean (nullable = true)
-- propertyDetails_attributes_oldBuilding: boolean (nullable = true)
-- propertyDetails_attributes_swimmingPool: boolean (nullable = true)
-- propertyDetails_attributes_underBuildingLaws: boolean (nullable = true)
-- propertyDetails_attributes_yearBuilt: long (nullable = true)
-- propertyDetails_attributes_yearRenovated: long (nullable = true)
-- propertyDetails_attributesInside_animalAllowed: boolean (nullable = true)
-- propertyDetails_attributesInside_attic: boolean (nullable = true)
-- propertyDetails_attributesInside_cellar: boolean (nullable = true)
-- propertyDetails_attributesInside_firePlace: boolean (nullable = true)
-- propertyDetails_attributesInside_nrBathRooms: long (nullable = true)
-- propertyDetails_attributesInside_propView: boolean (nullable = true)
-- propertyDetails_attributesInside_reduit: boolean (nullable = true)
-- propertyDetails_attributesInside_wheelChairAccessible: boolean (nullable = true)
-- propertyDetails_attributesOutside_playGround: boolean (nullable = true)
-- propertyDetails_attributesOutside_propBalcony: boolean (nullable = true)
-- propertyDetails_attributesOutside_propChildFriendly: boolean (nullable = true)
-- propertyDetails_attributesOutside_propElevator: boolean (nullable = true)
-- propertyDetails_attributesOutside_propGarage: boolean (nullable = true)
-- propertyDetails_attributesOutside_propParking: boolean (nullable = true)
-- propertyDetails_attributesSize_floor: long (nullable = true)
-- propertyDetails_attributesSize_floorFormatted: string (nullable = true)
-- propertyDetails_attributesSize_numberOfFloors: long (nullable = true)
-- propertyDetails_attributesSize_raisedGroundFloor: boolean (nullable = true)
-- propertyDetails_attributesSize_volume: long (nullable = true)
-- propertyDetails_attributesSize_volumeFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceKindergarten: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceKindergartenFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceMotorway: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceMotorwayFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distancePublicTransport: long (nullable = true)
-- propertyDetails_attributesSurrounding_distancePublicTransportFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool1: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool1Formatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool2: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceSchool2Formatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_distanceShop: long (nullable = true)
-- propertyDetails_attributesSurrounding_distanceShopFormatted: string (nullable = true)
-- propertyDetails_attributesSurrounding_objectSituation: string (nullable = true)
-- propertyDetails_attributesTechnology_dishWasher: boolean (nullable = true)
-- propertyDetails_attributesTechnology_isMinergieCertified: boolean (nullable = true)
-- propertyDetails_attributesTechnology_minergieGeneral: boolean (nullable = true)
-- propertyDetails_attributesTechnology_propCabletv: boolean (nullable = true)
-- propertyDetails_attributesTechnology_separateTumbleDryer: boolean (nullable = true)
-- propertyDetails_attributesTechnology_separateWashingMachine: boolean (nullable = true)
-- propertyDetails_attributesTechnology_steamer: boolean (nullable = true)
-- propertyDetails_images_description: string (nullable = true)
-- propertyDetails_images_id: long (nullable = true)
-- propertyDetails_images_lastModified: string (nullable = true)
-- propertyDetails_images_originalHeight: long (nullable = true)
-- propertyDetails_images_originalWidth: long (nullable = true)
-- propertyDetails_images_sortOrder: long (nullable = true)
-- propertyDetails_images_title: string (nullable = true)
-- propertyDetails_images_url: string (nullable = true)
-- propertyDetails_newBuildingLiteProject_projectDetailUrl: string (nullable = true)
-- propertyDetails_newBuildingLiteProject_projectName: string (nullable = true)
-- propertyDetails_pdfs_description: string (nullable = true)
-- propertyDetails_pdfs_id: long (nullable = true)
-- propertyDetails_pdfs_lastModified: string (nullable = true)
-- propertyDetails_pdfs_sortOrder: long (nullable = true)
-- propertyDetails_pdfs_title: string (nullable = true)
-- propertyDetails_pdfs_url: string (nullable = true)
-- propertyDetails_videos_description: string (nullable = true)
-- propertyDetails_videos_id: long (nullable = true)
-- propertyDetails_videos_lastModified: string (nullable = true)
-- propertyDetails_videos_remoteId: string (nullable = true)
-- propertyDetails_videos_sortOrder: long (nullable = true)
-- propertyDetails_videos_title: string (nullable = true)
-- propertyDetails_virtualTours_description: string (nullable = true)
-- propertyDetails_virtualTours_id: long (nullable = true)
-- propertyDetails_virtualTours_lastModified: string (nullable = true)
-- propertyDetails_virtualTours_sortOrder: long (nullable = true)
-- propertyDetails_virtualTours_title: string (nullable = true)
-- propertyDetails_virtualTours_url: string (nullable = true)
-- viewData_agencyBusinessImage_description: string (nullable = true)
-- viewData_agencyBusinessImage_id: long (nullable = true)
-- viewData_agencyBusinessImage_lastModified: string (nullable = true)
-- viewData_agencyBusinessImage_originalHeight: long (nullable = true)
-- viewData_agencyBusinessImage_originalWidth: long (nullable = true)
-- viewData_agencyBusinessImage_sortOrder: long (nullable = true)
-- viewData_agencyBusinessImage_title: string (nullable = true)
-- viewData_agencyBusinessImage_url: string (nullable = true)
-- viewData_viewDataWeb_accountPropertiesUrl: string (nullable = true)
-- viewData_viewDataWeb_copyShareUrl: string (nullable = true)
-- viewData_viewDataWeb_fbShareUrl: string (nullable = true)
-- viewData_viewDataWeb_whatsAppShareUrl: string (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_defaultPoiId: long (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_label: string (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_isReachable: boolean (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_transportationTypeId: long (nullable = true)
-- propertyDetails_commuteTimes_defaultPois_transportations_travelTime: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_activeLanguage: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_countImages: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_countPDF: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_country: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_customerType: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_englishVirtualPagePath: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_floorLevel: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasHighlighting: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasToplisting: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasVideoViewing: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasVirtualTour: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_hasYoutube: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isCooperation: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isNewBuilding: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_isShortUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingAccountId: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingCompletenessScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingId: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listingLayout: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_availability: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_cantonName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_locationName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_msregion: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_propertySpace: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_propertyType: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_listing_zip: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_livingSpace: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_localVirtualPagePath: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_numberOfRooms: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_offerTypeName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_packageName: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_packageScore: long (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_previewImageUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_price: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_sortingScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_streetName: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userLoggedIn: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userOrigin: string (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_userRelevantScore: double (nullable = true)
-- viewData_viewDataWeb_webView_gtmData_viewTab: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_description: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageHeight: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageType: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageUrl: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_imageWidth: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_title: string (nullable = true)
-- viewData_viewDataWeb_webView_openGraphData_url: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@context: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_@type: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_availability: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_description: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_image: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_name: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_price: long (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_priceCurrency: string (nullable = true)
-- viewData_viewDataWeb_webView_structuredData_@graph_url: string (nullable = true)

         
To overwrite your schema or change partitioning, please set:
'.option("overwriteSchema", "true")'.

Note that the schema can't be overwritten when using
'replaceWhere'.
         
	at org.apache.spark.sql.delta.MetadataMismatchErrorBuilder.finalizeAndThrow(DeltaErrors.scala:2460)
	at org.apache.spark.sql.delta.schema.ImplicitMetadataOperation.updateMetadata(ImplicitMetadataOperation.scala:129)
	at org.apache.spark.sql.delta.schema.ImplicitMetadataOperation.updateMetadata$(ImplicitMetadataOperation.scala:52)
	at org.apache.spark.sql.delta.commands.WriteIntoDelta.updateMetadata(WriteIntoDelta.scala:71)
	at org.apache.spark.sql.delta.commands.WriteIntoDelta.write(WriteIntoDelta.scala:207)
	at org.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1(WriteIntoDelta.scala:98)
	at org.apache.spark.sql.delta.commands.WriteIntoDelta.$anonfun$run$1$adapted(WriteIntoDelta.scala:91)
	at org.apache.spark.sql.delta.DeltaLog.withNewTransaction(DeltaLog.scala:221)
	at org.apache.spark.sql.delta.commands.WriteIntoDelta.run(WriteIntoDelta.scala:91)
	at org.apache.spark.sql.delta.sources.DeltaDataSource.createRelation(DeltaDataSource.scala:159)
	at org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:47)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:75)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:73)
	at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:84)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:116)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:860)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:390)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:303)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:239)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)


Stack Trace:
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/pyspark/sql/utils.py", line 190, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/Users/ctac/Desktop/Data Engineer /Projects/realestate_scraping_project/env/lib/python3.11/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
[0m
